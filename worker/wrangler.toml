# ============================================================
# CF Data Art Print Lab - Wrangler設定
# ============================================================

name = "cf-data-art-print-worker"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# ------------------------------------------------------------
# Cron Trigger: 毎時0分にサンプル生成（UTC）
# ------------------------------------------------------------
[triggers]
crons = ["0 * * * *"]

# ------------------------------------------------------------
# 環境変数（非シークレット - コミットOK）
# ------------------------------------------------------------
[vars]
APP_BASE_URL = "http://localhost:8788"
CORS_ALLOWED_ORIGINS = "http://localhost:8788"
POD_PROVIDER = "manual"

# ------------------------------------------------------------
# D1 Database
# ------------------------------------------------------------
# 作成コマンド:
#   wrangler d1 create cf_data_art_print_db
#
# 出力された database_id を下に設定
[[d1_databases]]
binding = "DB"
database_name = "cf_data_art_print_db"
database_id = "REPLACE_WITH_YOUR_D1_DATABASE_ID"

# ------------------------------------------------------------
# R2 Bucket（作品ファイル保存）
# ------------------------------------------------------------
# 作成コマンド:
#   wrangler r2 bucket create cf-data-art-print-artifacts
[[r2_buckets]]
binding = "ART_BUCKET"
bucket_name = "cf-data-art-print-artifacts"

# ============================================================
# 本番環境設定（wrangler deploy --env production）
# ============================================================
[env.production]
name = "cf-data-art-print-worker-prod"

[env.production.vars]
APP_BASE_URL = "https://your-domain.pages.dev"
CORS_ALLOWED_ORIGINS = "https://your-domain.pages.dev"
POD_PROVIDER = "manual"

# 本番用D1（別DBを使う場合）
# [[env.production.d1_databases]]
# binding = "DB"
# database_name = "cf_data_art_print_db_prod"
# database_id = "YOUR_PROD_D1_DATABASE_ID"

# 本番用R2
# [[env.production.r2_buckets]]
# binding = "ART_BUCKET"
# bucket_name = "cf-data-art-print-artifacts-prod"
